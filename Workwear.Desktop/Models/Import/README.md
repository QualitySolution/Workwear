# Общее

Модуль импорта со временем стал достаточно сложен. В этой файле попытка описать какие-то концепции.

# Основные концепции модуля

## Общие шаги импорта

1. Шаг 1 
   1. Пользователь выбирает файл и лист внутри файла.
2. Шаг 2
   1. Программа читает основные параметры листа, подбирает типы данных
   2. Пользователь корректирует типы данных
   3. Может проставить дополнительные настройки для каждого типа импорта.
3. Шаг 3
   1. Программа сопоставляет загруженные данные с данными из БД.
   2. Определяет что изменилось и нужно ли создавать объекты.
   3. Пользователь может перед сохранением, проверить корректность данных. И пометить строки которые не нужно сохранять.
4. Шаг 4
   1. Сохранение

## Типы данных

Для каждой модели импорта формируется список классов базирующихся на классе DataType, описывающий тип данных который может быть прочитан из колонки.
Первоначальная архитектура модуля не выделяла логику обработки каждого типа данных отдельный класс, поэтому еще остались списки типов данных в качестве перечисления, но они уже не являются обязательными и от них в будущем скорей всего совсем откажемся.

## Колонки

Колонки экселя, внутри имеют уровни с данными. Для создания уровней используется стандартная группировка строк внутри эксель.
1С очень много отчетов может выгружать в этом формате.

## Шаг сопоставления

На шаге сопоставления нельзя изменять сразу объект данных в который будет потом сохранен. Так как строка может быть пропущена пользователем.
Поэтому изменения к объектам применяются отложенно, На этапе анализа все необходимые изменения в объектах которые нужно сделать перед сохранением записываются в виде лябд в коллекцию SetValueActions строки.
