[#import]
= Импорт данных
:experimental:

NOTE: Функциональность доступна начиная с редакции «Профессиональная».

[#employees-excel-import]
== Загрузка сотрудников

Открыть диалог импортирования сотрудников можно через menu:База[Импорт данных > Сотрудники].

Исходно, данные для загрузки можно выгрузить из кадровой системы учета, например, в любой конфигурации 1С достаточно легко можно сохранить список сотрудников в Excel.
Программа умеет сопоставлять данные с имеющимися сотрудниками по табельным номерам, поэтому если вы будете выгружать данные с табельными номерами, вы легко сможете обновлять(синхронизировать) список сотрудников в программе с кадровым учетом.

Диалог импорта проведет вас по нескольким шагам:

=== Шаг 1 - Чтение файла

На первом шаге выбираем файл для загрузки ➊ и лист в Excel файле ➋.

image::import_employees-step-1.png[]

=== Шаг 2 - Настройка колонок

Сперва нам необходимо указать номер строки ➊, в которой содержится заголовок таблицы. Все что выше этой строки в файле будет пропущено. Если указано 0, это означает, что строка заголовка отсутствует и в первой строке идут загружаемые данные.

Далее настраиваем колонки в загруженном файле. Для каждой колонки данных ➋ информацию из которой мы хотим подгрузить, необходимо указать тип данных ➌. Если в колонке отсутствуют данные для загрузки, можно выбрать пункт "Пропустить".

NOTE: Первоначально программа пытается угадать тип данных в колонках.

image::import_employees-step-2.png[]

Программа поддерживает следующие типы данных:

ФИО:: Фамилия, Имя и Отчество, в одной колонке через пробел.
Фамилия:: Фамилия в отдельной колонке.
Имя:: Имя в отдельной колонке.
Отчество:: Отчество в отдельной колонке.
Пол:: Любое слово, начинающееся на "М"(русскую или английскую), воспринимается как мужской пол. А значение начинающееся с "Ж" или "F", воспринимается как женский. Если в файле нет отдельной колонки с полом, пол будет вычислен автоматически на основании имени сотрудника. Поддерживаются только русские имена.
Табельный номер:: Табельный номер до 15 символов.
UID карты:: Серийный номер СКУД карты сотрудника, используется в <<employees.adoc#identity-cards,системе выдачи по картам>>.
Дата приема на работу:: Заполняет соответствующее поле карточки.
Дата увольнения:: Проставляет дату увольнения текущему сотруднику, в основном имеет смысл для обновления данных.
Дата рождения:: Дата рождения сотрудника, можно использовать для отправки уведомлений с поздравлением.
Подразделение:: Название подразделения сотрудника, будет создано если не найдется с таким же названием.
Отдел:: Название отдела сотрудника, будет создан если не найдется с таким же названием.
Должность:: Название должности сотрудника, будет создана если не найдется с таким же названием.
Рост:: Рост, будет заполнен в карточке
Размер одежды:: Размер, будет заполнен в карточке
Размер обуви:: Размер, будет заполнен в карточке

Если установить галочку «Преобразовывать табельные номера в цифры», табельные номера "00135" превратятся в "135", без впереди идущих нулей, так же будут удалены все отличные от цифр символы. 

После того как все колонки настроены нажимаем btn:[Сопоставление сотрудников].

=== Шаг 3 - Сохранение данных

На следующем шаге программа обработает списки сотрудников, найдет уже имеющихся и выведет отчет.

image::import_employees-step-3.png[]

Правой кнопкой мышки можно отказаться от загрузки выбранного сотрудника. Нажимаем btn:[Сохранить] для сохранения изменений в базу данных.

== Загрузка норм

Диалог загрузки открывается через menu:База[Импорт данных > Нормы]. Первый шаг загрузки норм, аналогичен загрузке сотрудника, выбираем файл и лист с данными. На втором шаге выбираем тип данных в колонках, поддерживаются следующие типы данных:

Подразделение:: Подразделение у должности для которой загружается норма. Подразделение будет создано при отсутствии.
Должность:: Должность для которой загружается норма. Должность будет создана при отсутствии, должности с одним названием из разных подразделений считаются разными должностями. Должности можно перечислять через запятую, точку с запятой и наклонную черту, все они будут добавлены в одну норму.
Номенклатура нормы:: Номенклатура в строке нормы. Будет создана при отсутствии.
Количество и период:: Количество выдаваемой спецодежды и период выдачи. Поддерживается формат: "1 в 36 месяцев", "1 пара на 1,5 года", "до износа" и "дежурный". Если не указан период а только количество, то по умолчанию считается на год.

image::import_norm-step-2.png[]

[#excel-import-issue]
== Загрузка выдачи

Диалог загрузки открывается через menu:База[Импорт данных > Выдачи]. Первый шаг загрузки выдач, аналогичен загрузке сотрудника, выбираем файл и лист с данными. На втором шаге выбираем тип данных в колонках, поддерживаются следующие типы данных:

Табельный номер:: Табельный номер сотрудника, очень желательно чтобы он был при загрузке выдач, так как способ поиска сотрудника по ФИО не надежен.
Номенклатура нормы:: Наименование номенклатуры, указанной в норме.
Номенклатура выдачи:: Наименование складской номенклатуры, которая была выдана сотруднику.
Подразделение:: Подразделение сотрудника.
Должность:: Должность сотрудника.
Размер:: Размер выданной спецодежды, если в карточке сотрудника размер для данного типа спецодежды не заполнен, программа заполнит его по последней выдаче.
Рост:: Рост выданной спецодежды, аналогично предыдущему заполнит отсутствующее значение в карточке сотрудника.
Размер и рост:: Одновременно размер и рост в формате "104-108/170-176".
Дата выдачи:: Дата операции выдачи.
Количество:: Количество выданного.

image::import_issues-step-3.png[]

[#import-stock-incomes]
== Загрузка документов поступления

NOTE: Функциональность доступна начиная с редакции «Предприятие».

Программа позволяет загружать документы поступления из 1С. Для этого выберите menu:База[Импорт данных > Поступления].

Из 1С документы нужно выгрузить в формат xml. Поддерживается загрузка документов "Перемещение Товаров" и "Реализация товаров и услуг" выгруженные из конфигурации ERP. Оба типа документов, «QS: Спецодежда и имущество» попадут как поступление на склад. Загрузка документа перемещения из бухгалтерского учета в 1С, позволяет оформить внутренне передачу на склад спецодежды внутри бухгалтерского учета, как поступление на склад в программе выдачи спецодежды. Загрузка документа реализации позволяет не вбивать в ручную реализацию полученную от поставщика. Работа с другими конфигурациями 1С не тестировалась, обращайтесь в отдел разработки поможем с интеграцией.

image::import_incomes-1.png[]

Из 1С в один файла можно выгрузить несколько документов. После выбора файла, на первом шаге отмечаем галочками документы, нажимаем btn:[Загрузить].

TIP: Данные механизм загрузки создаст на каждый документ из 1С по документу внутри программы «QS: Спецодежда и имущество», если вам больше подходит вариант загрузки всех строк разных документов в один документ поступления используйте <<stock-documents.adoc#stock-income-load,другой способ загрузки>>.

image::import_incomes-2.png[]

На втором шаге, можно просмотреть и подправить загружаемые документы. Слева в верху диалога можно переключаться между различными загружаемыми документами. Если программа не сопоставила номенклатуру или размер с имеющимися они будут выделены красным цветом. В правой панели есть кнопка создать недостающие номенклатуры.

Не забудьте выбрать склад, на который хотите оформить эти поступления. 

При необходимости в строках документа можно отредактировать количество и стоимость. А через контекстное меню изменить размер или рост.

После проверки всех загружаемых документов нажимаем кнопку btn:[Создать поступление].