= Обновление
:experimental:

TIP: Обновляйте приложение регулярно! В новых версиях исправляются ошибки и расширяется функционал.

[#update-application]
== Обновление приложения

При наличии доступа в интернет с компьютера, на котором установлена программа, программа при запуске проверяет доступность новой версии. Проверку обновлений можно запустить в ручную через меню menu:Справка[Проверить обновление]. В случае возможности обновится, появится окно с предложением установить обновление.

image::update_update-info.png[]

Перед обновлением рекомендуем полностью прочитать информацию о изменениях. Обратите внимание на значок базы данных ❶ у некоторых версий. Его наличие означает что потребуется обновление структуры БД. Красный цвет значка сообщает о обратно несовместимом обновлении БД, фиолетовый об обычном. Подробнее описано в <<#update-database,разделе про обновление БД>>. Как правило более детальную информацию об изменениях можно почерпнуть из новости на сайте перейдя по ссылке ❷. Если есть возможность в нижней части диалога ❸ можно выбрать установщик какой версии скачивать. Иногда может потребоваться не обновляться на самую последнюю версию.

btn:[Пропустить обновление]:: Запомнить, что вы не хотите устанавливать эту версию. Не предлагать обновления до выхода следующего релиза.
btn:[Напомнить позже]:: Закрыть окно и начать работать сейчас в старой версии. Но при следующем запуске опять предложить обновится.
btn:[Скачать и установить]:: Запуск установки новой версии.

Если вы согласитесь на установку, автоматически загрузится и запустится установщик, такой же, как при установке новой программы.

image::update_winsetup.png[]

После нажатия несколько раз btn:[Далее >], установка новой версии приложения будет завершена.

[CAUTION]
====
Если у вас запущено несколько экземпляров программы закройте остальные. Иначе установка завершится ошибкой.

image::update_install-error.png[]
====

=== Каналы обновлений
Существует несколько каналов обновлений. Переключить используемый канал обновления можно с помощью меню menu:Справка[Канал обновлений]. Переключение повлияет только на ваш компьютер.

Текущий:: Активно разрабатываемая ветка приложения. При использовании ее пользователи получают новую функциональность сразу же после того как она разработана и протестирована. Обновления на этом канале выходят в среднем чаще чем на стабильном канале, каждое обновление как правило приносит новую функциональность. На канале достаточно часто выходят обновления требующие внесения изменений в БД, это значит что пользователи проводящие обновления должны иметь права администратора для обновления БД. Еще одним недостатком канала является потенциально большее количество ошибок, так как новая функциональность проходит только внутренне тестирование.
Стабильный:: Канал публикующий стабилизированные версии приложения. Здесь выходят только обновления исправляющие ошибки и обновления с переключением на следующую значительную версию. Например переход с 2.7 на 2.8, после того как поддержка версии 2.7 закончится. Версии опубликованные на канале как правило уже давно работают на многих предприятиях и содержат минимальное количество ошибок. Используйте этот канал если вам не нужна новая функциональность, а важна стабильность и редкие обновления.

[#update-database]
== Обновление базы данных

После обновления программы может потребоваться обновить так же структуру БД. Обновления базы данных бывают двух видов: обратно совместимые(обычные) и нарушающие совместимость. При изменении второй цифры в версии программы, в базу вносятся обратно не совместимые изменения. Это значит что при обновлении базы с 2.3 до версии 2.4, все клиенты программы версии 2.3 не смогут работать с обновленной базой данных. Но например при обновлении базы с 2.4.1 до 2.4.7, все клиенты версии от 2.4 до 2.4.7 смогут работать с обновленной базой, даже если они сами не были обновлены.

IMPORTANT: При обновлении программы со сменой второй цифры в версии планируйте одновременное обновление у всех пользователей.

Если из новой версии программы зайти в более старую БД под обычным пользователем(без прав администратора), программа выдаст следующее сообщение:

image::update_no-admin-message.png[]

Для выполнения обновления структуры базы данных нужно зайти под администратором. Это может быть, либо пользователь root, созданный при установке сервера, либо другой пользователь у которого проставлена галочка "Администрирование" <<users.adoc#user-edit,в правах пользователя>>. При входе с правами администратора, появится окно обновления БД.

image::update_start-update-db.png[]

Перед обновлением программа сделает резервную копию базы. Рекомендуем не снимать галочку создания резервной копии.

WARNING: При многопользовательской работе с базой данных, убедитесь что в момент обновления никто не работает в программе. Программа это автоматически не отслеживает, поэтому могут возникнуть непредсказуемые ошибки и даже произойти повреждение данных.

image::update_process-update-db.png[]

После завершения обновления, можно заходить в программу под обычным пользователем.
