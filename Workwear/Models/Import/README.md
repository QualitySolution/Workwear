# Общее

Модуль импорта со временем стал достаточно сложен. В этой файле попытка описать какие то концепции.
На текущий момент модуль требует значительного рефакторинга так как старая его структура оказалось достаточно слабо расширяемая и гибкая.
Так как рефакторинг дело сложное и долгое, текущее описание возможно еще не полностью реализовано в коде. А является скорее описанием направления движения.

# Основные концепции модуля

## Общие шаги

1. Шаг 1 
   1. Пользователь выбирает файл и лист внутри файла.
2. Шаг 2
   1. Программа читает основные параметры листа, подбирает типы данных
   2. Пользователь корректирует типы данных
3. Шаг 3
   1. Программа сопоставляет загруженные данные с данными из БД
   2. Определяет что изменилось и нужно ли создавать объекты.
4. Шаг 4
   1. Сохранение

## Типы данных

Для каждого набора загрузок есть тип данных который описывает как работать с данными в колонке.
Первоначальная архитектура модуля не выделяла логику обработки данных отдельный класс, но новая архитектура начинает стремится к этому.
То есть вплоть до создания отдельного класса под отдельную колонку, со всей логикой обработки данных внутри.
(Пока полностью не реализовано)

## Колонки

Колонки экселя, внутри имеют уровни, с данными. Для создания уровней используется стандартная групировка строк внутри эксель.
1С очень много отчетов может выгружать в этом формате.

## Шаг сопоставления

На шаге сопоставления нельзя изменять сразу объект данных в который будет потом сохранен. Так как строка может быть пропущена пользователем.
Поэтому если применять все изменения к объектам загрузки сразу. Можно накосячить и сохранить то что пользователь не хотел сохранять.
Поэтому при сопоставлении, в отдельный шаг выделено поиск изменение, сравнение данных из эксель файла с имеющимися в базе. Чтобы отобразить пользовтелю поменялось что-то или нет.
И уже перед самым сохранением мы редактируем сам объект.
